# Machine-specific configuration template
# Copy this file to _machine_config.sh and fill in your paths
# _machine_config.sh is gitignored â€” never commit it

# ============================================================================
# Directory Configuration
# ============================================================================
BASE_DIR="/path/to/your/base/directory"

# HuggingFace cache (models, tokenizers, datasets)
export HF_HOME="$BASE_DIR/.cache/huggingface"
export HF_DATASETS_CACHE="$HF_HOME/datasets"
export UV_CACHE_DIR="/vol/miltank/users/swek/.cache/uv"

# Preprocessed/packed parquet datasets (used in shells/*.sh via $PROCESSED_DATA_PATH)
export PROCESSED_DATA_PATH="$BASE_DIR/processed_datasets"

# ============================================================================
# SLURM Configuration
# ============================================================================

# GPU jobs (training, evaluation)
export SLURM_PARTITION_GPU="your-gpu-partition"
export SLURM_QOS_GPU="your-gpu-qos"
export SLURM_ACCOUNT=""                        # Optional: SLURM account (e.g., "eagle"), leave empty if not required
export NUM_GPUS="${NUM_GPUS:-2}"               # Number of GPUs per job (overridable via env)
export SLURM_GPU_TYPE="${SLURM_GPU_TYPE:-}"    # Optional: GPU type constraint (e.g., "h100", "a100"), leave empty for any GPU
export SLURM_GPU_MEM="${SLURM_GPU_MEM:-}"      # Optional: GPU memory per GPU (e.g., "20G"), leave empty if not supported
export SLURM_MEM_GPU="64G"
export SLURM_MAIL_USER="your.email@example.com"

# CPU jobs (data preprocessing, downloads)
export SLURM_PARTITION_CPU="your-cpu-partition"
export SLURM_QOS_CPU="your-cpu-qos"
export SLURM_MEM_CPU="32G"

# ============================================================================
# Validation
# ============================================================================

validate_config() {
    local required_vars=(HF_HOME HF_DATASETS_CACHE PROCESSED_DATA_PATH)
    for var in "${required_vars[@]}"; do
        if [ -z "${!var:-}" ]; then
            echo "ERROR: $var not set in machine_config.sh" >&2
            return 1
        fi
    done
    return 0
}
